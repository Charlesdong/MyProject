{% extends "base.html" %}

{% load markup %}
{% block content %}
<!-- main -->
        <div id="main">
   <!-- post -->
      	    <article class="post single">

                <!-- primary -->
         	    <div class="primary">

            	    <h2><a href="javascript:;">{{ object.title }}</a></h2>

                    <p class="post-info"><span>分类</span> <a href="javascript:;">{{ object.classify.title }}</a></p>

{#                    <div class="image-section">#}
{#              		    <img src="{{ STATIC_URL }}images/img-post.jpg" alt="image post" height="206" width="498"/>#}
{#         	        </div>#}

				    {{ object.content|markdown }}

                <!-- /primary -->
                </div>


            <aside>

            	<p class="dateinfo">JAN<span>31</span></p>

                <div class="post-meta">
               	    <h4>文章信息</h4>
                    <ul>
                    <li class="user"><a href="#">{{ object.author }}</a></li>
                    <li class="time"><a href="javascript:;">{{ object.createtime|date:"H:i a" }}</a></li>
                    <li class="comment"><a href="#">{{ object.comment.all|length }} comments</a></li>
                </ul>
                </div>



            </aside>

        <!-- /post -->
        </article>
        <div class="post-bottom-section">

		    <h4>评论</h4>

            <div class="primary">
            	<form action="index.html" method="post" id="commentform">
                    <div>
						<label for="email">邮箱<span>*</span></label>
						<input id="email" name="email" value="Your Email" type="text" tabindex="2" />
					</div>
                    <div>
						<label for="website">验证码</label>
						<input width="40px" value="输入验证码"/><img id="captcha" src="/captcha/image/1543c2acdb523646da678c4ba6f8f2a349f7a722/" style="display: none;"><a href="javascript:;" id="get_code">获取验证码</a>
					</div>
                    <div>
						<label for="message">内容<span>*</span></label>
						<textarea id="message" name="message" rows="10" cols="18" tabindex="4"></textarea>
					</div>
                    <div class="no-border">
					    <input class="button" type="submit" value="Submit Comment" tabindex="5" />
					</div>

               </form>

            </div>

         </div>
    </div>
{% endblock %}

{% block js %}
<script>
$('#get_code').click(function(){
   $.ajax({
		 type: "get",
		 async: false,
		 url: "{% url 'captcha-ajax' %}",
		 dataType: "json",
		 success: function(respond){
             if (respond.result == 'success'){
                 $('#captcha').show();
                 $('#captcha').attr("src", respond.image_url);
                 $('#get_code').html("不会算？");
             }else{
                 alert("获取验证码失败");
             }
         },
         error: function(){
			 alert('后台数据出错');
		 }
   });
});
</script>

{% endblock %}

